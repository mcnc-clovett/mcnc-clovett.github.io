<!doctype html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.3.3" /><meta property="og:title" content="GnuPG - Encrypting Files with a Public Key" /><meta property="og:locale" content="en" /><meta name="description" content="Encrypting files or data with a public key is called asymmetric encryption. The benefit to this method is the extra security of encrypting data for a specific recipient. This is done by using the person’s public key to encrypt the data, which they then decrypt with their private key that only they have access to. Using this method, you do not have to exchange a password which could compromise the confidential data." /><meta property="og:description" content="Encrypting files or data with a public key is called asymmetric encryption. The benefit to this method is the extra security of encrypting data for a specific recipient. This is done by using the person’s public key to encrypt the data, which they then decrypt with their private key that only they have access to. Using this method, you do not have to exchange a password which could compromise the confidential data." /><link rel="canonical" href="https://mcnc-clovett.github.io/posts/gpg-public-key/" /><meta property="og:url" content="https://mcnc-clovett.github.io/posts/gpg-public-key/" /><meta property="og:site_name" content="MCNC CNE" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-02-08T23:00:00-05:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="GnuPG - Encrypting Files with a Public Key" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-04-19T15:17:19-04:00","datePublished":"2022-02-08T23:00:00-05:00","description":"Encrypting files or data with a public key is called asymmetric encryption. The benefit to this method is the extra security of encrypting data for a specific recipient. This is done by using the person’s public key to encrypt the data, which they then decrypt with their private key that only they have access to. Using this method, you do not have to exchange a password which could compromise the confidential data.","headline":"GnuPG - Encrypting Files with a Public Key","mainEntityOfPage":{"@type":"WebPage","@id":"https://mcnc-clovett.github.io/posts/gpg-public-key/"},"url":"https://mcnc-clovett.github.io/posts/gpg-public-key/"}</script><title>GnuPG - Encrypting Files with a Public Key | MCNC CNE</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="MCNC CNE"><meta name="application-name" content="MCNC CNE"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.6.0/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.29.0/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css"> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return 'mode'; } static get MODE_ATTR() { return 'data-mode'; } static get DARK_MODE() { return 'dark'; } static get LIGHT_MODE() { return 'light'; } static get ID() { return 'mode-toggle'; } constructor() { let self = this;this.sysDarkPrefers.addEventListener('change', () => { if (self.hasMode) { self.clearMode(); } self.notify(); }); if (!this.hasMode) { return; } if (this.isDarkMode) { this.setDark(); } else { this.setLight(); } } get sysDarkPrefers() { return window.matchMedia('(prefers-color-scheme: dark)'); } get isPreferDark() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); }get modeStatus() { if (this.hasMode) { return this.mode; } else { return this.isPreferDark ? ModeToggle.DARK_MODE : ModeToggle.LIGHT_MODE; } } setDark() { document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { document.documentElement.removeAttribute(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); }notify() { window.postMessage( { direction: ModeToggle.ID, message: this.modeStatus }, '*' ); } flipMode() { if (this.hasMode) { this.clearMode(); } else { if (this.isPreferDark) { this.setLight(); } else { this.setDark(); } } this.notify(); } } const modeToggle = new ModeToggle(); </script><body><aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end"><header class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"><img src="https://raw.githubusercontent.com/mcnc-clovett/cdn/master/common/mcnc_cne_300.png" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a><h1 class="site-title"> <a href="/">MCNC CNE</a></h1><p class="site-subtitle fst-italic mb-0">Client Network Engineers</p></header><nav class="flex-column flex-grow-1 w-100 ps-0"><ul class="nav"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/webinars/" class="nav-link"> <i class="fa-fw fas fa-code"></i> <span>WEBINARS</span> </a><li class="nav-item"> <a href="/free-tools/" class="nav-link"> <i class="fa-fw fas fa-tools"></i> <span>FREE TOOLS</span> </a><li class="nav-item"> <a href="/pac-file-code/" class="nav-link"> <i class="fa-fw fas fa-code"></i> <span>PAC SNIPPETS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a></ul></nav><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <button type="button" class="btn btn-link nav-link" aria-label="Switch Mode" id="mode-toggle"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/mcnc-clovett" aria-label="github" target="_blank" rel="noopener noreferrer" > <i class="fab fa-github"></i> </a> <a href="javascript:location.href = 'mailto:' + ['clovett','mcnc.org'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></aside><div id="main-wrapper" class="d-flex justify-content-center"><div class="container d-flex flex-column px-xxl-5"><header id="topbar-wrapper" aria-label="Top Bar"><div id="topbar" class="d-flex align-items-center justify-content-between px-lg-3 h-100" ><nav id="breadcrumb" aria-label="Breadcrumb"> <span> <a href="/">Home</a> </span> <span>GnuPG - Encrypting Files with a Public Key</span></nav><button type="button" id="sidebar-trigger" class="btn btn-link"> <i class="fas fa-bars fa-fw"></i> </button><div id="topbar-title"> Post</div><button type="button" id="search-trigger" class="btn btn-link"> <i class="fas fa-search fa-fw"></i> </button> <search id="search" class="align-items-center ms-3 ms-lg-0"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </search> <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button></div></header><div class="row flex-grow-1"><main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4"><article class="px-1"><header><h1 data-toc-skip>GnuPG - Encrypting Files with a Public Key</h1><div class="post-meta text-muted"> <span> Posted <time data-ts="1644379200" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Feb 8, 2022 </time> </span> <span> Updated <time data-ts="1650395839" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Apr 19, 2022 </time> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://github.com/mcnc-clovett">Chris Lovett</a> </em> </span><div> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="3633 words" > <em>20 min</em> read</span></div></div></div></header><div class="content"><p>Encrypting files or data with a public key is called asymmetric encryption. The benefit to this method is the extra security of encrypting data for a specific recipient. This is done by using the person’s <strong>public key</strong> to encrypt the data, which they then decrypt with their <strong>private key</strong> that only they have access to. Using this method, you do not have to exchange a password which could compromise the confidential data.</p><p>Public keys are kept in a <strong>keyring</strong> on your computer so that you can easily use them again and again. You can also create your own <strong>keypair</strong> to share your public key with others and receive encypted data, as well as use your private key to sign data so people know the data came from you.</p><p>Here, we’ll walk through encrypting and decrypting data using public key encryption in GnuPG.</p><h3 id="publickeys"><span class="me-2">Obtaining Public Keys</span><a href="#publickeys" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>You can obtain someone’s public key by any of the typical means including, email, external drive or even physical paper. Sending this key in plaintext is perfectly safe, which is why it is called the public key. You import a key using a couple different methods.</p><p>If someone shares the key file with you, you can use the <code class="language-plaintext highlighter-rouge">--import</code> option in <code class="language-plaintext highlighter-rouge">gpg</code>.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre>~ <span class="nv">$ </span>gpg <span class="nt">--import</span> myfriend.asc
gpg: key D5A4CF5ABE861374: public key <span class="s2">"Christopher Lovett &lt;clovett@mailbox.mcnc.org&gt;"</span> imported
gpg: Total number processed: 1
gpg:               imported: 1

~ <span class="nv">$ </span>gpg <span class="nt">-k</span> D5A4CF5ABE861374
pub   ed25519/D5A4CF5ABE861374 2021-01-17 <span class="o">[</span>C] <span class="o">[</span>expires: 2023-11-13]
      Key fingerprint <span class="o">=</span> 764F 8DCD BAF1 8D49 7717  88AD D5A4 CF5A BE86 1374
uid                 <span class="o">[</span>ultimate] Christopher Lovett &lt;clovett@mailbox.mcnc.org&gt;
uid                 <span class="o">[</span>ultimate] Christopher Lovett &lt;clovett@mcnc.org&gt;
sub   rsa4096/5BBCA0B2FFC0B65D 2021-01-21 <span class="o">[</span>S] <span class="o">[</span>expires: 2022-05-12]
sub   rsa4096/DE1D6F0A38429A0B 2021-01-21 <span class="o">[</span>E] <span class="o">[</span>expires: 2022-05-12]
sub   rsa4096/5F950E2EA7D452E4 2021-01-21 <span class="o">[</span>A] <span class="o">[</span>expires: 2022-05-12]
</pre></table></code></div></div><p>If the person has stored their key on a <a href="https://keys.openpgp.org/">keyserver</a>, like I have at <a href="https://keys.openpgp.org/">https://keys.openpgp.org/</a>, you may import the key directly within the <code class="language-plaintext highlighter-rouge">gpg</code> tool.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>~ <span class="nv">$ </span>gpg <span class="nt">--keyserver</span> hkps://keys.openpgp.org <span class="nt">--search-key</span> clovett@mcnc.org
gpg: data <span class="nb">source</span>: https://keys.openpgp.org:443
<span class="o">(</span>1<span class="o">)</span>     Christopher Lovett &lt;clovett@mailbox.mcnc.org&gt;
        Christopher Lovett &lt;clovett@mcnc.org&gt;
          256 bit EDDSA key D5A4CF5ABE861374, created: 2021-01-17
Keys 1-1 of 1 <span class="k">for</span> <span class="s2">"clovett@mcnc.org"</span><span class="nb">.</span>  Enter number<span class="o">(</span>s<span class="o">)</span>, N<span class="o">)</span>ext, or Q<span class="o">)</span>uit <span class="o">&gt;</span> 1 <span class="c"># Enter the number of the key you wish to import</span>
gpg: key D5A4CF5ABE861374: public key <span class="s2">"Christopher Lovett &lt;clovett@mailbox.mcnc.org&gt;"</span> imported
gpg: Total number processed: 1
gpg:               imported: 1
</pre></table></code></div></div><h3 id="encryptfile"><span class="me-2">Encrypting a File</span><a href="#encryptfile" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>GnuPG can only encrypt one file at a time, so if you have many files to send, you’ll want to <code class="language-plaintext highlighter-rouge">zip</code> or <code class="language-plaintext highlighter-rouge">tar</code> them first. If you’re sending a single file, then this is not necessary. Lets say you have a batch of employee data that needs to be sent or stored, for example. Use the tool of your choosing to aggregate the data into a single file (eg. mybulkdata.zip). Next, use <code class="language-plaintext highlighter-rouge">gpg</code> with option <code class="language-plaintext highlighter-rouge">-e</code> to encrypt the data. We’ll use a few more options as well.</p><ul><li><code class="language-plaintext highlighter-rouge">-e</code> or <code class="language-plaintext highlighter-rouge">--encrypt</code> tells gpg to encrypt with the public key given with <em>name</em>.<li><code class="language-plaintext highlighter-rouge">-r name</code> or <code class="language-plaintext highlighter-rouge">--recipient name</code> will encrypt for user id <em>name</em>. If this option is not specified, GnuPG asks for the user-id. This is the id associated with the public key of the recipient.</ul><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre>~ <span class="nv">$ </span>gpg <span class="nt">-e</span> <span class="nt">-r</span> clovett@mcnc.org mybulkdata.zip
<span class="c"># You may receive this warning. This is because you haven't signed the recipient's</span>
<span class="c"># public key. If you are sure this is the correct key, you can answer 'y'.</span>
gpg: DE1D6F0A38429A0B: There is no assurance this key belongs to the named user

sub  rsa4096/DE1D6F0A38429A0B 2021-01-21 Christopher Lovett &lt;clovett@mailbox.mcnc.org&gt;
 Primary key fingerprint: 764F 8DCD BAF1 8D49 7717  88AD D5A4 CF5A BE86 1374
      Subkey fingerprint: 4D81 E207 C4B1 6C69 968B  4108 DE1D 6F0A 3842 9A0B

It is NOT certain that the key belongs to the person named
<span class="k">in </span>the user ID.  If you <span class="k">*</span>really<span class="k">*</span> know what you are doing,
you may answer the next question with yes.

Use this key anyway? <span class="o">(</span>y/N<span class="o">)</span> y    <span class="c"># Answer 'y' here if you're sure this is the correct key</span>

~ <span class="nv">$ </span><span class="nb">ls </span>mybulkdata.zip<span class="k">*</span>
<span class="nt">-rw-r--r--</span>  1 user  385788673 mybulkdata.zip
<span class="nt">-rw-r--r--</span>  1 user  385788781 mybulkdata.zip.gpg
</pre></table></code></div></div><p>You can now store or send this confidential data and the recipient can decrypt the file with their private key.</p><h3 id="encryptmessage"><span class="me-2">Encrypting a Short Message</span><a href="#encryptmessage" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>With GnuPG, you can encypt a message without ever writing the data to disk in plaintext. To do so, we’ll use the <code class="language-plaintext highlighter-rouge">-o file</code>, <code class="language-plaintext highlighter-rouge">-e</code>, <code class="language-plaintext highlighter-rouge">-a</code> and <code class="language-plaintext highlighter-rouge">-r name</code> options.</p><ul><li><code class="language-plaintext highlighter-rouge">-o file</code> or <code class="language-plaintext highlighter-rouge">--output file</code> is used to send output to <em>file</em>.<li><code class="language-plaintext highlighter-rouge">-e</code> or <code class="language-plaintext highlighter-rouge">--encrypt</code> tells gpg to encrypt with the public key given with <em>name</em>.<li><code class="language-plaintext highlighter-rouge">-a</code> or <code class="language-plaintext highlighter-rouge">--armor</code> to create ASCII armored output. The default is to create the binary OpenPGP format. This is optional, but the output can be easily copy-pasted to email or instant message.<li><code class="language-plaintext highlighter-rouge">-r name</code> or <code class="language-plaintext highlighter-rouge">--recipient name</code> will encrypt for user id <em>name</em>. If this option is not specified, GnuPG asks for the user-id. This is the id associated with the public key of the recipient.</ul><p>If you do not provide an input file or any input from the pipleine (<code class="language-plaintext highlighter-rouge">|</code>), then gpg waits for you to type a message, after which you will press <code class="language-plaintext highlighter-rouge">Ctrl-D</code> or <code class="language-plaintext highlighter-rouge">Ctrl-Z</code> to signify you are done. If you used <code class="language-plaintext highlighter-rouge">-o filename.gpg</code>, then the encrypted data will be stored in <em>filename.gpg</em>.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre><td class="rouge-code"><pre>~ <span class="nv">$ </span>gpg <span class="nt">-o</span> message.asc <span class="nt">-e</span> <span class="nt">-a</span> <span class="nt">-r</span> clovett@mcnc.org
<span class="c"># You may receive this error. This is because you haven't signed the recipient's</span>
<span class="c"># public key. If you are sure this is the correct key, you can answer 'y'.</span>
gpg: DE1D6F0A38429A0B: There is no assurance this key belongs to the named user

sub  rsa4096/DE1D6F0A38429A0B 2021-01-21 Christopher Lovett &lt;clovett@mailbox.mcnc.org&gt;
 Primary key fingerprint: 764F 8DCD BAF1 8D49 7717  88AD D5A4 CF5A BE86 1374
      Subkey fingerprint: 4D81 E207 C4B1 6C69 968B  4108 DE1D 6F0A 3842 9A0B

It is NOT certain that the key belongs to the person named
<span class="k">in </span>the user ID.  If you <span class="k">*</span>really<span class="k">*</span> know what you are doing,
you may answer the next question with yes.

Use this key anyway? <span class="o">(</span>y/N<span class="o">)</span> y    <span class="c"># Answer 'y' here if you're sure this is the correct key</span>
This is a message I encrypted.    <span class="c"># Enter your message and end with a blank line</span>
<span class="c"># Press &lt;Ctrl-D&gt; on macOS or Linux, &lt;Ctrl-Z&gt;&lt;Enter&gt; on Windows</span>

~ <span class="nv">$ </span><span class="nb">ls </span>message.gpg 
<span class="nt">-rw-r--r--</span>  1 user  106 message.asc
</pre></table></code></div></div><p>You can now send the output file via email or other means. The recipient can decrypt the file with their private key.</p><h3 id="privatekeys"><span class="me-2">Creating Your Own Keypair</span><a href="#privatekeys" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Sending encrypted files and verifying signatures are only half of the things you can do with <code class="language-plaintext highlighter-rouge">gpg</code>. You may need to receive data or sign it yourself. To do this, you’ll need your own <strong>keypair</strong>.</p><p>You’ll see that keys can have expiration dates. These can be updated at any time, even after expiration, provided you still have access to the private key. Expiration dates are used to ensure others update their copy of your key and prevent someone from using a stolen subkey after expiration, among other things. It is good practice to set an expiration <em>at least</em> for your subkeys.</p><blockquote class="prompt-warning"><p>The private key is your identity to others, which they must be able to trust. You should keep the private key safe at all costs. For example, my private master key is stored on physical paper and on USB drive in a fire-proof lock box.</p></blockquote><h4 id="quickmethod"><span class="me-2">Quick Key Creation</span><a href="#quickmethod" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="c"># Create a new master key that never expires</span>
~ <span class="nv">$ </span>gpg <span class="nt">--quick-gen-key</span> <span class="s1">'Big Cootie &lt;bigcootie@example.com&gt;'</span> ed25519 cert 0
We need to generate a lot of random bytes. It is a good idea to perform
some other action <span class="o">(</span><span class="nb">type </span>on the keyboard, move the mouse, utilize the
disks<span class="o">)</span> during the prime generation<span class="p">;</span> this gives the random number
generator a better chance to gain enough entropy.
<span class="c"># GnuPG will prompt for a password to secure the new private key</span>
gpg: key 163F9BB1EB0CC234 marked as ultimately trusted
gpg: revocation certificate stored as <span class="s1">'/Users/user/.gnupg/openpgp-revocs.d/CEB8AD11C13AF31E86FB3DF7163F9BB1EB0CC234.rev'</span>
public and secret key created and signed.

pub   ed25519 2021-11-15 <span class="o">[</span>C]
      CEB8AD11C13AF31E86FB3DF7163F9BB1EB0CC234
uid                            Big Cootie &lt;bigcootie@example.com&gt;
</pre></table></code></div></div><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="c"># Create signing subkey using the 'fingerprint' of the new master key</span>
<span class="c"># that expires in 6 months</span>
~ <span class="nv">$ </span>gpg <span class="nt">--quick-add-key</span> CEB8AD11C13AF31E86FB3DF7163F9BB1EB0CC234 ed25519 sign 6m
We need to generate a lot of random bytes. It is a good idea to perform
some other action <span class="o">(</span><span class="nb">type </span>on the keyboard, move the mouse, utilize the
disks<span class="o">)</span> during the prime generation<span class="p">;</span> this gives the random number
generator a better chance to gain enough entropy.
<span class="c"># GnuPG will prompt for the private key's password from earlier</span>
</pre></table></code></div></div><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="c"># Create encryption subkey using the 'fingerprint' of the new master key</span>
<span class="c"># that expires in 6 mounths</span>
~ <span class="nv">$ </span>gpg <span class="nt">--quick-add-key</span> CEB8AD11C13AF31E86FB3DF7163F9BB1EB0CC234 cv25519 encrypt 6m
We need to generate a lot of random bytes. It is a good idea to perform
some other action <span class="o">(</span><span class="nb">type </span>on the keyboard, move the mouse, utilize the
disks<span class="o">)</span> during the prime generation<span class="p">;</span> this gives the random number
generator a better chance to gain enough entropy.
<span class="c"># GnuPG will prompt for the private key's password from earlier</span>
</pre></table></code></div></div><h4 id="detailedmethod"><span class="me-2">Detailed Key Creation</span><a href="#detailedmethod" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre>~ <span class="nv">$ </span>gpg <span class="nt">--full-gen-key</span> <span class="nt">--expert</span>
gpg <span class="o">(</span>GnuPG<span class="o">)</span> 2.3.3<span class="p">;</span> Copyright <span class="o">(</span>C<span class="o">)</span> 2021 Free Software Foundation, Inc.
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.

Please <span class="k">select </span>what kind of key you want:
   <span class="o">(</span>1<span class="o">)</span> RSA and RSA
   <span class="o">(</span>2<span class="o">)</span> DSA and Elgamal
   <span class="o">(</span>3<span class="o">)</span> DSA <span class="o">(</span>sign only<span class="o">)</span>
   <span class="o">(</span>4<span class="o">)</span> RSA <span class="o">(</span>sign only<span class="o">)</span>
   <span class="o">(</span>7<span class="o">)</span> DSA <span class="o">(</span><span class="nb">set </span>your own capabilities<span class="o">)</span>
   <span class="o">(</span>8<span class="o">)</span> RSA <span class="o">(</span><span class="nb">set </span>your own capabilities<span class="o">)</span>
   <span class="o">(</span>9<span class="o">)</span> ECC <span class="o">(</span>sign and encrypt<span class="o">)</span> <span class="k">*</span>default<span class="k">*</span>
  <span class="o">(</span>10<span class="o">)</span> ECC <span class="o">(</span>sign only<span class="o">)</span>
  <span class="o">(</span>11<span class="o">)</span> ECC <span class="o">(</span><span class="nb">set </span>your own capabilities<span class="o">)</span>
  <span class="o">(</span>13<span class="o">)</span> Existing key
  <span class="o">(</span>14<span class="o">)</span> Existing key from card
Your selection? 11    <span class="c"># Enter '11' to select an ECC key</span>
</pre></table></code></div></div><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>Possible actions <span class="k">for </span>this ECC key: Sign Certify Authenticate 
Current allowed actions: Sign Certify 

   <span class="o">(</span>S<span class="o">)</span> Toggle the sign capability
   <span class="o">(</span>A<span class="o">)</span> Toggle the authenticate capability
   <span class="o">(</span>Q<span class="o">)</span> Finished

Your selection? s    <span class="c"># Enter 's' to turn off signing</span>
</pre></table></code></div></div><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>Possible actions <span class="k">for </span>this ECC key: Sign Certify Authenticate 
Current allowed actions: Certify 

   <span class="o">(</span>S<span class="o">)</span> Toggle the sign capability
   <span class="o">(</span>A<span class="o">)</span> Toggle the authenticate capability
   <span class="o">(</span>Q<span class="o">)</span> Finished

Your selection? q    <span class="c"># Enter 'q' to finish</span>
</pre></table></code></div></div><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre>Please <span class="k">select </span>which elliptic curve you want:
   <span class="o">(</span>1<span class="o">)</span> Curve 25519 <span class="k">*</span>default<span class="k">*</span>
   <span class="o">(</span>2<span class="o">)</span> Curve 448
   <span class="o">(</span>3<span class="o">)</span> NIST P-256
   <span class="o">(</span>4<span class="o">)</span> NIST P-384
   <span class="o">(</span>5<span class="o">)</span> NIST P-521
   <span class="o">(</span>6<span class="o">)</span> Brainpool P-256
   <span class="o">(</span>7<span class="o">)</span> Brainpool P-384
   <span class="o">(</span>8<span class="o">)</span> Brainpool P-512
   <span class="o">(</span>9<span class="o">)</span> secp256k1
Your selection? 1    <span class="c"># Enter '1' to use a Curve 25519 key</span>
</pre></table></code></div></div><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>Please specify how long the key should be valid.
         0 <span class="o">=</span> key does not expire
      &lt;n&gt;  <span class="o">=</span> key expires <span class="k">in </span>n days
      &lt;n&gt;w <span class="o">=</span> key expires <span class="k">in </span>n weeks
      &lt;n&gt;m <span class="o">=</span> key expires <span class="k">in </span>n months
      &lt;n&gt;y <span class="o">=</span> key expires <span class="k">in </span>n years
Key is valid <span class="k">for</span>? <span class="o">(</span>0<span class="o">)</span> 0    <span class="c"># Enter '0' or your desired expiration period</span>
</pre></table></code></div></div><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>Key does not expire at all
Is this correct? <span class="o">(</span>y/N<span class="o">)</span> y    <span class="c"># Enter 'y' to finish the key setup</span>
</pre></table></code></div></div><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>GnuPG needs to construct a user ID to identify your key.

Real name: Big Cootie    <span class="c"># Enter your name</span>
Email address: bigcootie@example.com    <span class="c"># Enter your email address</span>
Comment:     <span class="c"># A comment is optional</span>
</pre></table></code></div></div><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>You selected this USER-ID:
    <span class="s2">"Big Cootie &lt;bigcootie@example.com&gt;"</span>

Change <span class="o">(</span>N<span class="o">)</span>ame, <span class="o">(</span>C<span class="o">)</span>omment, <span class="o">(</span>E<span class="o">)</span>mail or <span class="o">(</span>O<span class="o">)</span>kay/<span class="o">(</span>Q<span class="o">)</span>uit? o    <span class="c"># Enter 'o' to complete the uid</span>
</pre></table></code></div></div><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre>We need to generate a lot of random bytes. It is a good idea to perform
some other action <span class="o">(</span><span class="nb">type </span>on the keyboard, move the mouse, utilize the
disks<span class="o">)</span> during the prime generation<span class="p">;</span> this gives the random number
generator a better chance to gain enough entropy.
<span class="c"># GnuPG will prompt for a password to secure the new private key</span>
gpg: key AD551B435E0EA0BC marked as ultimately trusted
gpg: revocation certificate stored as <span class="s1">'/Users/user/.gnupg/openpgp-revocs.d/DE6C0EA75D05EA6300BE78D1AD551B435E0EA0BC.rev'</span>
public and secret key created and signed.

pub   ed25519 2021-11-15 <span class="o">[</span>C]
      DE6C0EA75D05EA6300BE78D1AD551B435E0EA0BC
uid                            Big Cootie &lt;bigcootie@example.com&gt;
</pre></table></code></div></div><p>Now create your subkeys, one for signing and one for encryption.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre>~ <span class="nv">$ </span>gpg <span class="nt">--edit-key</span> <span class="nt">--expert</span> bigcootie@example.com
gpg <span class="o">(</span>GnuPG<span class="o">)</span> 2.3.3<span class="p">;</span> Copyright <span class="o">(</span>C<span class="o">)</span> 2021 Free Software Foundation, Inc.
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.

Secret key is available.

sec  ed25519/AD551B435E0EA0BC
     created: 2021-11-15  expires: never  usage: C   
     trust: ultimate      validity: ultimate
<span class="o">[</span>ultimate] <span class="o">(</span>1<span class="o">)</span><span class="nb">.</span> Big Cootie &lt;bigcootie@example.com&gt;

gpg&gt; addkey    <span class="c"># Enter 'addkey' to add a new subkey</span>
</pre></table></code></div></div><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre>Please <span class="k">select </span>what kind of key you want:
   <span class="o">(</span>3<span class="o">)</span> DSA <span class="o">(</span>sign only<span class="o">)</span>
   <span class="o">(</span>4<span class="o">)</span> RSA <span class="o">(</span>sign only<span class="o">)</span>
   <span class="o">(</span>5<span class="o">)</span> Elgamal <span class="o">(</span>encrypt only<span class="o">)</span>
   <span class="o">(</span>6<span class="o">)</span> RSA <span class="o">(</span>encrypt only<span class="o">)</span>
   <span class="o">(</span>7<span class="o">)</span> DSA <span class="o">(</span><span class="nb">set </span>your own capabilities<span class="o">)</span>
   <span class="o">(</span>8<span class="o">)</span> RSA <span class="o">(</span><span class="nb">set </span>your own capabilities<span class="o">)</span>
  <span class="o">(</span>10<span class="o">)</span> ECC <span class="o">(</span>sign only<span class="o">)</span>
  <span class="o">(</span>11<span class="o">)</span> ECC <span class="o">(</span><span class="nb">set </span>your own capabilities<span class="o">)</span>
  <span class="o">(</span>12<span class="o">)</span> ECC <span class="o">(</span>encrypt only<span class="o">)</span>
  <span class="o">(</span>13<span class="o">)</span> Existing key
  <span class="o">(</span>14<span class="o">)</span> Existing key from card
Your selection? 10    <span class="c"># Enter '10' for an ECC signing key</span>
</pre></table></code></div></div><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre>Please <span class="k">select </span>which elliptic curve you want:
   <span class="o">(</span>1<span class="o">)</span> Curve 25519 <span class="k">*</span>default<span class="k">*</span>
   <span class="o">(</span>2<span class="o">)</span> Curve 448
   <span class="o">(</span>3<span class="o">)</span> NIST P-256
   <span class="o">(</span>4<span class="o">)</span> NIST P-384
   <span class="o">(</span>5<span class="o">)</span> NIST P-521
   <span class="o">(</span>6<span class="o">)</span> Brainpool P-256
   <span class="o">(</span>7<span class="o">)</span> Brainpool P-384
   <span class="o">(</span>8<span class="o">)</span> Brainpool P-512
   <span class="o">(</span>9<span class="o">)</span> secp256k1
Your selection? 1    <span class="c"># Enter '1' for Curve 25519</span>
</pre></table></code></div></div><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>Please specify how long the key should be valid.
         0 <span class="o">=</span> key does not expire
      &lt;n&gt;  <span class="o">=</span> key expires <span class="k">in </span>n days
      &lt;n&gt;w <span class="o">=</span> key expires <span class="k">in </span>n weeks
      &lt;n&gt;m <span class="o">=</span> key expires <span class="k">in </span>n months
      &lt;n&gt;y <span class="o">=</span> key expires <span class="k">in </span>n years
Key is valid <span class="k">for</span>? <span class="o">(</span>0<span class="o">)</span> 6m    <span class="c"># Enter '6m' or your desired expiration period</span>
Key expires at Sat May 14 18:46:58 2022 EDT
Is this correct? <span class="o">(</span>y/N<span class="o">)</span> y    <span class="c"># Enter 'y' to confirm</span>
Really create? <span class="o">(</span>y/N<span class="o">)</span> y    <span class="c"># Enter 'y' to be extra sure</span>
</pre></table></code></div></div><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre>We need to generate a lot of random bytes. It is a good idea to perform
some other action <span class="o">(</span><span class="nb">type </span>on the keyboard, move the mouse, utilize the
disks<span class="o">)</span> during the prime generation<span class="p">;</span> this gives the random number
generator a better chance to gain enough entropy.
<span class="c"># GnuPG will prompt for the private key's password from earlier</span>

sec  ed25519/AD551B435E0EA0BC
     created: 2021-11-15  expires: never  usage: C   
     trust: ultimate      validity: ultimate
ssb  ed25519/E4E10D8C00A4AEC8
     created: 2021-11-15  expires: 2022-05-14  usage: S   
<span class="o">[</span>ultimate] <span class="o">(</span>1<span class="o">)</span><span class="nb">.</span> Big Cootie &lt;bigcootie@example.com&gt;

gpg&gt; addkey    <span class="c"># Enter 'addkey' to add a new subkey</span>
</pre></table></code></div></div><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre>Please <span class="k">select </span>what kind of key you want:
   <span class="o">(</span>3<span class="o">)</span> DSA <span class="o">(</span>sign only<span class="o">)</span>
   <span class="o">(</span>4<span class="o">)</span> RSA <span class="o">(</span>sign only<span class="o">)</span>
   <span class="o">(</span>5<span class="o">)</span> Elgamal <span class="o">(</span>encrypt only<span class="o">)</span>
   <span class="o">(</span>6<span class="o">)</span> RSA <span class="o">(</span>encrypt only<span class="o">)</span>
   <span class="o">(</span>7<span class="o">)</span> DSA <span class="o">(</span><span class="nb">set </span>your own capabilities<span class="o">)</span>
   <span class="o">(</span>8<span class="o">)</span> RSA <span class="o">(</span><span class="nb">set </span>your own capabilities<span class="o">)</span>
  <span class="o">(</span>10<span class="o">)</span> ECC <span class="o">(</span>sign only<span class="o">)</span>
  <span class="o">(</span>11<span class="o">)</span> ECC <span class="o">(</span><span class="nb">set </span>your own capabilities<span class="o">)</span>
  <span class="o">(</span>12<span class="o">)</span> ECC <span class="o">(</span>encrypt only<span class="o">)</span>
  <span class="o">(</span>13<span class="o">)</span> Existing key
  <span class="o">(</span>14<span class="o">)</span> Existing key from card
Your selection? 12    <span class="c"># Enter '12' for an ECC encryption key</span>
</pre></table></code></div></div><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre>Please <span class="k">select </span>which elliptic curve you want:
   <span class="o">(</span>1<span class="o">)</span> Curve 25519 <span class="k">*</span>default<span class="k">*</span>
   <span class="o">(</span>2<span class="o">)</span> Curve 448
   <span class="o">(</span>3<span class="o">)</span> NIST P-256
   <span class="o">(</span>4<span class="o">)</span> NIST P-384
   <span class="o">(</span>5<span class="o">)</span> NIST P-521
   <span class="o">(</span>6<span class="o">)</span> Brainpool P-256
   <span class="o">(</span>7<span class="o">)</span> Brainpool P-384
   <span class="o">(</span>8<span class="o">)</span> Brainpool P-512
   <span class="o">(</span>9<span class="o">)</span> secp256k1
Your selection? 1    <span class="c"># Enter '1' for Curve 25519</span>
</pre></table></code></div></div><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>Please specify how long the key should be valid.
         0 <span class="o">=</span> key does not expire
      &lt;n&gt;  <span class="o">=</span> key expires <span class="k">in </span>n days
      &lt;n&gt;w <span class="o">=</span> key expires <span class="k">in </span>n weeks
      &lt;n&gt;m <span class="o">=</span> key expires <span class="k">in </span>n months
      &lt;n&gt;y <span class="o">=</span> key expires <span class="k">in </span>n years
Key is valid <span class="k">for</span>? <span class="o">(</span>0<span class="o">)</span> 6m    <span class="c"># Enter '6m' or your desired expiration period</span>
Key expires at Sat May 14 19:04:06 2022 EDT
Is this correct? <span class="o">(</span>y/N<span class="o">)</span> y    <span class="c"># Enter 'y' to confirm</span>
Really create? <span class="o">(</span>y/N<span class="o">)</span> y    <span class="c"># Enter 'y' to be extra sure</span>
</pre></table></code></div></div><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre>We need to generate a lot of random bytes. It is a good idea to perform
some other action <span class="o">(</span><span class="nb">type </span>on the keyboard, move the mouse, utilize the
disks<span class="o">)</span> during the prime generation<span class="p">;</span> this gives the random number
generator a better chance to gain enough entropy.
<span class="c"># GnuPG will prompt for the private key's password from earlier</span>

sec  ed25519/AD551B435E0EA0BC
     created: 2021-11-15  expires: never  usage: C   
     trust: ultimate      validity: ultimate
ssb  ed25519/E4E10D8C00A4AEC8
     created: 2021-11-15  expires: 2022-05-14  usage: S   
ssb  cv25519/9CA997BF45733016
     created: 2021-11-15  expires: 2022-05-14  usage: E   
<span class="o">[</span>ultimate] <span class="o">(</span>1<span class="o">)</span><span class="nb">.</span> Big Cootie &lt;bigcootie@example.com&gt;

gpg&gt; save    <span class="c"># Enter 'save' to save the changes and exit gpg</span>
</pre></table></code></div></div><h4 id="publicexport"><span class="me-2">Exporting Your Public Key</span><a href="#publicexport" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>You’ll need to share your public key with others for them to send you encrypted data. I recommend using the <code class="language-plaintext highlighter-rouge">-a</code> and <code class="language-plaintext highlighter-rouge">-o file</code> along with <code class="language-plaintext highlighter-rouge">--export</code> to export your public key to a text file.</p><ul><li><code class="language-plaintext highlighter-rouge">-o file</code> or <code class="language-plaintext highlighter-rouge">--output file</code> is used to send output to <em>file</em>.<li><code class="language-plaintext highlighter-rouge">-a</code> or <code class="language-plaintext highlighter-rouge">--armor</code> to create ASCII armored output. The default is to create the binary OpenPGP format.<li><code class="language-plaintext highlighter-rouge">--export</code> to either export all keys from all keyrings (default keyring and those registered via option –keyring), or if at least one name is given, those of the given name.</ul><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>~ <span class="nv">$ </span>gpg <span class="nt">-o</span> bigcootie.pub <span class="nt">-a</span> <span class="nt">--export</span> bigcootie@example.com
</pre></table></code></div></div><p>You can now share the output file, <code class="language-plaintext highlighter-rouge">bigcootie.pub</code> in this case, with whoever you need to converse with.</p><p>You can also upload your key to a keyserver. Upload the public key file here:</p><ul><li><a href="https://keys.openpgp.org/upload">https://keys.openpgp.org/upload</a></ul><h4 id="guardthekeys"><span class="me-2">Guard Your Keys</span><a href="#guardthekeys" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>You should also create a revocation certificate that you can upload to keyservers if your key is compromised. This certificate and your private key should be backed up offline and secured.</p><p>The following will export your private key and create a revocation certificate:</p><ul><li><code class="language-plaintext highlighter-rouge">-o file</code> or <code class="language-plaintext highlighter-rouge">--output file</code> is used to send output to <em>file</em>.<li><code class="language-plaintext highlighter-rouge">-a</code> or <code class="language-plaintext highlighter-rouge">--armor</code> to create ASCII armored output. The default is to create the binary OpenPGP format.<li><code class="language-plaintext highlighter-rouge">--export-secret-key</code> Same as –export, but exports the secret keys instead. The exported keys are written to STDOUT or to the file given with option –output. This command is often used along with the option –armor to allow for easy printing of the key for paper backup; however the external tool paperkey does a better job of creating backups on paper. Note that exporting a secret key can be a security risk if the exported keys are sent over an insecure channel.<li><code class="language-plaintext highlighter-rouge">--gen-revoke name</code> or <code class="language-plaintext highlighter-rouge">--generate-revocation name</code> will generate a revocation certificate for the complete key.</ul><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre><td class="rouge-code"><pre><span class="c"># Export your secret key</span>
~ <span class="nv">$ </span>gpg <span class="nt">-o</span> bigcootie.sec <span class="nt">--export-secret-key</span> <span class="nt">-a</span> bigcootie@example.com
<span class="c"># GnuPG will ask for the password to your key so it can be exported</span>

<span class="c"># Create a revocation certificate</span>
~ <span class="nv">$ </span>gpg <span class="nt">-o</span> bigcootie.rev <span class="nt">--gen-revoke</span> bigcootie@example.com

sec  ed25519/163F9BB1EB0CC234 2021-11-15 Big Cootie &lt;bigcootie@example.com&gt;

Create a revocation certificate <span class="k">for </span>this key? <span class="o">(</span>y/N<span class="o">)</span> y    <span class="c"># Enter 'y' to continue</span>
Please <span class="k">select </span>the reason <span class="k">for </span>the revocation:
  0 <span class="o">=</span> No reason specified
  1 <span class="o">=</span> Key has been compromised
  2 <span class="o">=</span> Key is superseded
  3 <span class="o">=</span> Key is no longer used
  Q <span class="o">=</span> Cancel
<span class="o">(</span>Probably you want to <span class="k">select </span>1 here<span class="o">)</span>
Your decision? 0    <span class="c"># Enter '0' or '1' reason for the revocation</span>
Enter an optional description<span class="p">;</span> end it with an empty line:
<span class="o">&gt;</span>     <span class="c"># A description is optional</span>
Reason <span class="k">for </span>revocation: No reason specified
<span class="o">(</span>No description given<span class="o">)</span>
Is this okay? <span class="o">(</span>y/N<span class="o">)</span> y    <span class="c"># Enter 'y' to continue</span>
ASCII armored output forced.
Revocation certificate created.

Please move it to a medium which you can hide away<span class="p">;</span> <span class="k">if </span>Mallory gets
access to this certificate he can use it to make your key unusable.
It is smart to print this certificate and store it away, just <span class="k">in case</span>
your media become unreadable.  But have some caution:  The print system of
your machine might store the data and make it available to others!
</pre></table></code></div></div><h3 id="decryptfile"><span class="me-2">Decrypting a File</span><a href="#decryptfile" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Decrypting is a straightforward process. When you receive a file that is encrypted with a password, simply run <code class="language-plaintext highlighter-rouge">gpg</code> with the <code class="language-plaintext highlighter-rouge">-d</code> and <code class="language-plaintext highlighter-rouge">-o file</code> options. This will prompt for the password and store the location specified by <em>file</em>. If the data is a simple text file that you just wish to output to the terminal, you can leave off the <code class="language-plaintext highlighter-rouge">-o</code> option.</p><ul><li><code class="language-plaintext highlighter-rouge">-d</code> or <code class="language-plaintext highlighter-rouge">--decrypt</code> will decrypt the file given on the command line (or STDIN if no file is specified) and write it to STDOUT (or the file specified with –output). If the decrypted file is signed, the signature is also verified.<li><code class="language-plaintext highlighter-rouge">-o file</code> or <code class="language-plaintext highlighter-rouge">--output file</code> is used to send output to <em>file</em>.</ul><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="c"># For binary files or data you wish to save to disk...</span>

~ <span class="nv">$ </span>gpg <span class="nt">-d</span> <span class="nt">-o</span> mybulkdata.zip mybulkdata.zip.gpg
gpg: encrypted with cv25519 key, ID 24FDDB38B2CF1DE8, created 2021-11-15
      <span class="s2">"Big Cootie &lt;bigcootie@example.com&gt;"</span>
<span class="c"># GnuPG will prompt for a password</span>
</pre></table></code></div></div><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="c"># For simple text you want to display to the terminal...</span>

~ <span class="nv">$ </span>gpg <span class="nt">-d</span> message.gpg
gpg: encrypted with cv25519 key, ID 24FDDB38B2CF1DE8, created 2021-11-15
      <span class="s2">"Big Cootie &lt;bigcootie@example.com&gt;"</span>
<span class="c"># GnuPG will prompt for a password</span>
This is a message I encrypted.
</pre></table></code></div></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href="/categories/security/">Security</a>, <a href="/categories/encryption/">Encryption</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/security/" class="post-tag no-text-decoration" >security</a> <a href="/tags/gpg/" class="post-tag no-text-decoration" >gpg</a> <a href="/tags/gnupg/" class="post-tag no-text-decoration" >gnupg</a> <a href="/tags/pgp/" class="post-tag no-text-decoration" >pgp</a> <a href="/tags/encryption/" class="post-tag no-text-decoration" >encryption</a></div><div class=" post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2 " ><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper d-flex align-items-center"> <span class="share-label text-muted">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=GnuPG%20-%20Encrypting%20Files%20with%20a%20Public%20Key%20-%20MCNC%20CNE&url=https%3A%2F%2Fmcnc-clovett.github.io%2Fposts%2Fgpg-public-key%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=GnuPG%20-%20Encrypting%20Files%20with%20a%20Public%20Key%20-%20MCNC%20CNE&u=https%3A%2F%2Fmcnc-clovett.github.io%2Fposts%2Fgpg-public-key%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fmcnc-clovett.github.io%2Fposts%2Fgpg-public-key%2F&text=GnuPG%20-%20Encrypting%20Files%20with%20a%20Public%20Key%20-%20MCNC%20CNE" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fmcnc-clovett.github.io%2Fposts%2Fgpg-public-key%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Linkedin" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <button id="copy-link" aria-label="Copy link" class="btn small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > <i class="fa-fw fas fa-link pe-none fs-6"></i> </button> </span></div></div></div></article></main><aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 mb-5 text-muted"><div class="access"><section id="access-lastmod"><h2 class="panel-heading">Recently Updated</h2><ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/posts/enterprise-sub-ca/">Creating an Enterprise Subordinate CA from an Offline Root CA</a><li class="text-truncate lh-lg"> <a href="/posts/ssl_certificate_management/">SSL Certificate Management</a><li class="text-truncate lh-lg"> <a href="/posts/offline-linux-ca/">Offline Root Certificate Authority - Linux</a><li class="text-truncate lh-lg"> <a href="/posts/allowing-wifi-calling/">Allowing Wifi Calling</a><li class="text-truncate lh-lg"> <a href="/posts/create-domain-join-account/">Creating a Domain Join Account in AD</a></ul></section><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/security/">security</a> <a class="post-tag btn btn-outline-primary" href="/tags/windows/">windows</a> <a class="post-tag btn btn-outline-primary" href="/tags/certificate/">certificate</a> <a class="post-tag btn btn-outline-primary" href="/tags/networking/">networking</a> <a class="post-tag btn btn-outline-primary" href="/tags/encryption/">encryption</a> <a class="post-tag btn btn-outline-primary" href="/tags/gnupg/">gnupg</a> <a class="post-tag btn btn-outline-primary" href="/tags/gpg/">gpg</a> <a class="post-tag btn btn-outline-primary" href="/tags/pgp/">pgp</a> <a class="post-tag btn btn-outline-primary" href="/tags/active-directory/">active directory</a> <a class="post-tag btn btn-outline-primary" href="/tags/ssh/">ssh</a></div></section></div><section id="toc-wrapper" class="d-none ps-0 pe-4"><h2 class="panel-heading ps-3 mb-2">Contents</h2><nav id="toc"></nav></section></aside></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4"><aside id="related-posts" aria-labelledby="related-label"><h3 class="mb-4" id="related-label">Further Reading</h3><nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><article class="col"> <a href="/posts/installing-gpg/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1637035200" data-df="ll" > Nov 15, 2021 </time><h4 class="pt-0 my-2">GnuPG - Intro & Installation</h4><div class="text-muted"><p>You can skip right to the installation for Windows or macOS. GnuPG is included in all major Linux distributions. Introduction GnuPG or “GNU Privacy Guard” is a free and open source implementation ...</p></div></div></a></article><article class="col"> <a href="/posts/gpg-symmetric/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1637035200" data-df="ll" > Nov 15, 2021 </time><h4 class="pt-0 my-2">GnuPG - Encrypting Files with a Password</h4><div class="text-muted"><p>Encrypting files or data with a password is called symmetric encryption. The benefit to this method is the speed of the encryption and decryption process, so it is more suited to large files and da...</p></div></div></a></article><article class="col"> <a href="/posts/securing-admins-with-smart-cards-yk/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1616731200" data-df="ll" > Mar 26, 2021 </time><h4 class="pt-0 my-2">Securing Admins with Smart Cards (Yubikeys)</h4><div class="text-muted"><p>We all know that giving local admin rights to normal users is a big no-no, but what happens if an administrator’s account is compromised? What if a domain admin’s account credentials are obtained? ...</p></div></div></a></article></nav></aside><nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation"> <a href="/posts/installing-gpg/" class="btn btn-outline-primary" aria-label="Older" ><p>GnuPG - Intro & Installation</p></a> <a href="/posts/linux-based-sftp-server/" class="btn btn-outline-primary" aria-label="Newer" ><p>Linux-based SFTP Server</p></a></nav><footer aria-label="Site Info" class=" d-flex flex-column justify-content-center text-muted flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3 " ><p>© <time>2024</time> <a href="https://github.com/mcnc-clovett">Chris Lovett</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >Some rights reserved.</span></p><p>Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a data-bs-toggle="tooltip" data-bs-placement="top" title="v7.1.0" href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener" >Chirpy</a> theme.</p></footer></div></div><div id="search-result-wrapper" class="d-flex justify-content-center d-none"><div class="col-11 content"><div id="search-hints"><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/security/">security</a> <a class="post-tag btn btn-outline-primary" href="/tags/windows/">windows</a> <a class="post-tag btn btn-outline-primary" href="/tags/certificate/">certificate</a> <a class="post-tag btn btn-outline-primary" href="/tags/networking/">networking</a> <a class="post-tag btn btn-outline-primary" href="/tags/encryption/">encryption</a> <a class="post-tag btn btn-outline-primary" href="/tags/gnupg/">gnupg</a> <a class="post-tag btn btn-outline-primary" href="/tags/gpg/">gpg</a> <a class="post-tag btn btn-outline-primary" href="/tags/pgp/">pgp</a> <a class="post-tag btn btn-outline-primary" href="/tags/active-directory/">active directory</a> <a class="post-tag btn btn-outline-primary" href="/tags/ssh/">ssh</a></div></section></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><aside aria-label="Scroll to Top"> <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button></aside></div><div id="mask"></div><script src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/en.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js,npm/tocbot@4.29.0/dist/tocbot.min.js"></script> <script src="/assets/js/dist/post.min.js"></script> <script>SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<article class="px-1 px-sm-2 px-lg-4 px-xl-0"><header><h2><a href="{url}">{title}</a></h2><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div></header><p>{snippet}</p></article>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
