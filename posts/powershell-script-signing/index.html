<!doctype html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.3.3" /><meta property="og:title" content="PowerShell Script Signing" /><meta property="og:locale" content="en" /><meta name="description" content="Windows PowerShell has what’s called an Execution Policy. This policy defines how scripts are handled, and by default it is set to Restricted, which means no script is allowed to run. This is to prevent anyone from accidentally running a rogue script on the computer. What we typically see are Execution Policies set to Bypass, which allows any script to run. Anyone with administrative rights can set this, which makes Execution Policy more of a safety feature than a security one." /><meta property="og:description" content="Windows PowerShell has what’s called an Execution Policy. This policy defines how scripts are handled, and by default it is set to Restricted, which means no script is allowed to run. This is to prevent anyone from accidentally running a rogue script on the computer. What we typically see are Execution Policies set to Bypass, which allows any script to run. Anyone with administrative rights can set this, which makes Execution Policy more of a safety feature than a security one." /><link rel="canonical" href="https://mcnc-clovett.github.io/posts/powershell-script-signing/" /><meta property="og:url" content="https://mcnc-clovett.github.io/posts/powershell-script-signing/" /><meta property="og:site_name" content="MCNC CNE" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-03-06T23:00:00-05:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="PowerShell Script Signing" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-04-19T15:17:19-04:00","datePublished":"2021-03-06T23:00:00-05:00","description":"Windows PowerShell has what’s called an Execution Policy. This policy defines how scripts are handled, and by default it is set to Restricted, which means no script is allowed to run. This is to prevent anyone from accidentally running a rogue script on the computer. What we typically see are Execution Policies set to Bypass, which allows any script to run. Anyone with administrative rights can set this, which makes Execution Policy more of a safety feature than a security one.","headline":"PowerShell Script Signing","mainEntityOfPage":{"@type":"WebPage","@id":"https://mcnc-clovett.github.io/posts/powershell-script-signing/"},"url":"https://mcnc-clovett.github.io/posts/powershell-script-signing/"}</script><title>PowerShell Script Signing | MCNC CNE</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="MCNC CNE"><meta name="application-name" content="MCNC CNE"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.6.0/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.29.0/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css"> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return 'mode'; } static get MODE_ATTR() { return 'data-mode'; } static get DARK_MODE() { return 'dark'; } static get LIGHT_MODE() { return 'light'; } static get ID() { return 'mode-toggle'; } constructor() { let self = this;this.sysDarkPrefers.addEventListener('change', () => { if (self.hasMode) { self.clearMode(); } self.notify(); }); if (!this.hasMode) { return; } if (this.isDarkMode) { this.setDark(); } else { this.setLight(); } } get sysDarkPrefers() { return window.matchMedia('(prefers-color-scheme: dark)'); } get isPreferDark() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); }get modeStatus() { if (this.hasMode) { return this.mode; } else { return this.isPreferDark ? ModeToggle.DARK_MODE : ModeToggle.LIGHT_MODE; } } setDark() { document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { document.documentElement.removeAttribute(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); }notify() { window.postMessage( { direction: ModeToggle.ID, message: this.modeStatus }, '*' ); } flipMode() { if (this.hasMode) { this.clearMode(); } else { if (this.isPreferDark) { this.setLight(); } else { this.setDark(); } } this.notify(); } } const modeToggle = new ModeToggle(); </script><body><aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end"><header class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"><img src="https://raw.githubusercontent.com/mcnc-clovett/cdn/master/common/mcnc_cne_300.png" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a><h1 class="site-title"> <a href="/">MCNC CNE</a></h1><p class="site-subtitle fst-italic mb-0">Client Network Engineers</p></header><nav class="flex-column flex-grow-1 w-100 ps-0"><ul class="nav"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/webinars/" class="nav-link"> <i class="fa-fw fas fa-code"></i> <span>WEBINARS</span> </a><li class="nav-item"> <a href="/free-tools/" class="nav-link"> <i class="fa-fw fas fa-tools"></i> <span>FREE TOOLS</span> </a><li class="nav-item"> <a href="/pac-file-code/" class="nav-link"> <i class="fa-fw fas fa-code"></i> <span>PAC SNIPPETS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a></ul></nav><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <button type="button" class="btn btn-link nav-link" aria-label="Switch Mode" id="mode-toggle"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/mcnc-clovett" aria-label="github" target="_blank" rel="noopener noreferrer" > <i class="fab fa-github"></i> </a> <a href="javascript:location.href = 'mailto:' + ['clovett','mcnc.org'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></aside><div id="main-wrapper" class="d-flex justify-content-center"><div class="container d-flex flex-column px-xxl-5"><header id="topbar-wrapper" aria-label="Top Bar"><div id="topbar" class="d-flex align-items-center justify-content-between px-lg-3 h-100" ><nav id="breadcrumb" aria-label="Breadcrumb"> <span> <a href="/">Home</a> </span> <span>PowerShell Script Signing</span></nav><button type="button" id="sidebar-trigger" class="btn btn-link"> <i class="fas fa-bars fa-fw"></i> </button><div id="topbar-title"> Post</div><button type="button" id="search-trigger" class="btn btn-link"> <i class="fas fa-search fa-fw"></i> </button> <search id="search" class="align-items-center ms-3 ms-lg-0"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </search> <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button></div></header><div class="row flex-grow-1"><main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4"><article class="px-1"><header><h1 data-toc-skip>PowerShell Script Signing</h1><div class="post-meta text-muted"> <span> Posted <time data-ts="1615089600" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Mar 6, 2021 </time> </span> <span> Updated <time data-ts="1650395839" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Apr 19, 2022 </time> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://github.com/mcnc-clovett">Chris Lovett</a> </em> </span><div> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="927 words" > <em>5 min</em> read</span></div></div></div></header><div class="content"><p>Windows PowerShell has what’s called an <strong>Execution Policy</strong>. This policy defines how scripts are handled, and by default it is set to <strong>Restricted</strong>, which means no script is allowed to run. This is to prevent anyone from accidentally running a rogue script on the computer. What we typically see are Execution Policies set to <strong>Bypass</strong>, which allows any script to run. Anyone with administrative rights can set this, which makes Execution Policy more of a <em>safety</em> feature than a <em>security</em> one.</p><p>There are two policies that require scripts to be signed, RemoteSigned and AllSigned. RemoteSigned requires that any script downloaded from the internet be signed. This way you can be sure that the script wasn’t altered in transit. AllSigned means that every script that runs must be signed and valid, which includes local scripts that you create yourself. If you run a signed script under either of these policies that isn’t signed by a Trusted Publisher, you’ll be prompted with a warning. Also, if the script was altered since it was last signed by you or anyone else, you’ll receive an error. This is a way that you can trust the scripts you’ve written haven’t been altered with some malicious code trying to trick you into infecting your entire network.</p><h2 id="templates"><span class="me-2">Configure the Certificate Templates</span><a href="#templates" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ol><li>Open the <strong>Certificate Authority Console</strong> for your CA, right click <strong>Certificate Templates</strong> and click <strong>Manage</strong><li>Right click the <strong>Code Signing</strong> template then <strong>Duplicate Certificate</strong><li>Under <strong>General</strong> tab:<ul><li>Name the new template (ie. <em>“PS Code Signing”</em>)<li>Enter a Validity Period (ie. 2 years)</ul><li>Under <strong>Compatibility</strong> tab:<ul><li>Select the OS version of your CA server<li>Select the oldest version of Windows in the district</ul><li>Under <strong>Request Handling</strong> tab:<ul><li>Check <strong>Allow private key to be exported</strong><li>Select <strong>Prompt the user during enrollment and require user input when the private key is used</strong></ul><li>Under <strong>Cryptography</strong> tab:<ul><li>For <strong>Provider Category</strong>, select <strong>Key Storage Provider</strong><li>For <strong>Algorithm name</strong> ensure <strong>ECDSA_P256</strong> is selected and <strong>Minimum key size</strong> is <strong>256</strong><li>Select <strong>Requests must use one of the following providers</strong> and check <strong>Microsoft Software Ley Storage Provider</strong><li>Set <strong>Request hash</strong> to <strong>SHA256</strong></ul><li>Under <strong>Security</strong> tab:<ul><li>Add the group or users that you wish to be able to sign scripts for the district, and that they have the <strong>Read</strong> and <strong>Enroll</strong> permissions</ul><li>Click <strong>OK</strong> and close the <strong>Certificate Templates Console</strong><li>Open certsrv.msc, right click Certificate Templates &gt; <strong>New &gt; Certificate Template to Issue</strong><li>Select the code signing certificate you created (ie. <em>“PS Code Signing”</em>) then click <strong>OK</strong></ol><h2 id="enrollment"><span class="me-2">Enroll for a Signing Certificate</span><a href="#enrollment" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ol><li>Open certmgr.msc and under <strong>Personal\Certificates</strong>:<li>Right click in the white space &gt; <strong>All Tasks &gt; Request New Certificate…</strong><li>Click <strong>Next</strong>, <strong>Next</strong><li>Select the code signing certificate you created (ie. <em>“PS Code Signing”</em>) and click <strong>Enroll</strong><li>Export the private key:<ol><li>Right click the new certificate &gt; <strong>All Tasks &gt; Export…</strong><li>Click <strong>Next</strong>, <strong>Next</strong>, <strong>Next</strong><li>Enter a save location and filename (ie. <em>publicSigningKey.cer</em>) and click <strong>Next</strong><li>Click <strong>Finish</strong></ol><li>Export the private key:<ol><li>Right click the new certificate &gt; <strong>All Tasks &gt; Export…</strong><li>Click <strong>Next</strong><li>Select <strong>Yes</strong>, export the private key, click <strong>Next</strong><ul><li><strong>**Optional</strong>** If you’re going to use your code signing key on a Yubikey or similar device, check <strong>Delete the private key if the export is successful</strong></ul><li>Click <strong>Next</strong><li>Check the box for Password protection and enter a secure password, set <strong>Encryption</strong> to <strong>AES256-SHA256</strong> and click <strong>Next</strong><li>Enter a save location and filename (ie. <em>privateSigningKey.pfx</em>) and click <strong>Next</strong><li>Click <strong>Finish</strong></ol></ol><h2 id="gpos"><span class="me-2">Configure the Group Policy Objects</span><a href="#gpos" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ol><li>Under <strong>Computer Configuration&gt;Administrative Templates&gt;Windows Components&gt;Windows PowerShell</strong>:<ol><li>Double-click <strong>Turn on Script Execution</strong><ol><li>Check <strong>Enabled</strong><li>From the dropdown, choose <strong>Allow only signed scripts</strong></ol></ol><li>Under <strong>Computer Configuration&gt;Policies&gt;Windows Settings&gt;Security Settings&gt;Public Key Policies&gt;Trusted Publishers</strong>:<ol><li>Right click in the white space &gt; <strong>Import…</strong><li>Click <strong>Next</strong><li>Browse for the public certificate that you exported previously (ie. <em>publicSigningKey.cer</em>)<li>Click <strong>Next</strong>, enter the password used when the certificate was exported, click <strong>Next</strong>, <strong>Finish</strong></ol><li>Open PowerShell and run <code class="language-plaintext highlighter-rouge">gpupdate /force</code></ol><h2 id="signing"><span class="me-2">Sign a Script and Test</span><a href="#signing" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ol><li>Open PowerShell as the user who was issued the certificate<li>Create a test script with<div class="language-powershell highlighter-rouge"><div class="code-header"> <span data-label-text="Powershell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">echo</span><span class="w"> </span><span class="err">“</span><span class="nx">Write-Host</span><span class="w"> </span><span class="err">‘</span><span class="nx">Hello</span><span class="w"> </span><span class="nx">World</span><span class="o">!</span><span class="err">’”</span><span class="w"> </span><span class="err">&gt;</span><span class="w"> </span><span class="nx">test.ps1</span><span class="w">
</span></pre></table></code></div></div><li>Store the certificate in a variable with<div class="language-powershell highlighter-rouge"><div class="code-header"> <span data-label-text="Powershell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$cert</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Get-ChildItem</span><span class="w"> </span><span class="nx">Cert:\CurrentUser\My</span><span class="w"> </span><span class="nt">-CodeSigningCert</span><span class="w">
</span></pre></table></code></div></div><li>Sign the script<div class="language-powershell highlighter-rouge"><div class="code-header"> <span data-label-text="Powershell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">Set-AuthenticodeSignature</span><span class="w"> </span><span class="nt">-Certificate</span><span class="w"> </span><span class="nv">$cert</span><span class="w"> </span><span class="nt">-TimestampServer</span><span class="w"> </span><span class="nx">http://timestamp.digicert.com</span><span class="w"> </span><span class="o">.</span><span class="nx">\test.ps1</span><span class="w">
</span></pre></table></code></div></div><ul><li>The time stamp server is important because without a verified time of signing, the script will no longer be vaid if your certificate expires. Using a time stamp certification in the signature will verify that the certificate was valid at the time it was signed.</ul><li>Verify the script was signed<div class="language-powershell highlighter-rouge"><div class="code-header"> <span data-label-text="Powershell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">Get-AuthenticodeSignature</span><span class="w"> </span><span class="o">.</span><span class="nx">\test.ps1</span><span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="n">select</span><span class="w"> </span><span class="o">*</span><span class="w">
</span></pre></table></code></div></div><li>Run the script <code class="language-plaintext highlighter-rouge">./test.ps1</code></ol><p>If you open your script in Notepad or type <code class="language-plaintext highlighter-rouge">cat test.ps1</code>, you’ll see a long block of random letters and numbers. This is the new signature you’ve just applied. If you change any part of the script, this signature will no longer be valid and display an error when ran. To validate any changes you make, you simply re-sign the certificate as before. Since you added your signing certificate to <strong>Trusted Publishers</strong> in a GPO, all machines in your domain will trust that the script is legitimate.</p><h2 id="secure-your-private-key"><span class="me-2">Secure Your Private Key</span><a href="#secure-your-private-key" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Your private signing key that we exported earlier is very important and shouldn’t be shared with anyone. If you wish to use this key on another PC, you’ll need to import it. It is highly recommended that you place this file in a secure location, and also add your key to a device that supports Personal Identity Verification (PIV), such as a Yubikey. Using a PIV device allows you to carry your signing key and use it wherever needed, without having to import the key itself.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href="/categories/powershell/">Powershell</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/powershell/" class="post-tag no-text-decoration" >powershell</a> <a href="/tags/security/" class="post-tag no-text-decoration" >security</a> <a href="/tags/certificates/" class="post-tag no-text-decoration" >certificates</a> <a href="/tags/code-signing/" class="post-tag no-text-decoration" >code signing</a></div><div class=" post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2 " ><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper d-flex align-items-center"> <span class="share-label text-muted">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=PowerShell%20Script%20Signing%20-%20MCNC%20CNE&url=https%3A%2F%2Fmcnc-clovett.github.io%2Fposts%2Fpowershell-script-signing%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=PowerShell%20Script%20Signing%20-%20MCNC%20CNE&u=https%3A%2F%2Fmcnc-clovett.github.io%2Fposts%2Fpowershell-script-signing%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fmcnc-clovett.github.io%2Fposts%2Fpowershell-script-signing%2F&text=PowerShell%20Script%20Signing%20-%20MCNC%20CNE" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fmcnc-clovett.github.io%2Fposts%2Fpowershell-script-signing%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Linkedin" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <button id="copy-link" aria-label="Copy link" class="btn small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > <i class="fa-fw fas fa-link pe-none fs-6"></i> </button> </span></div></div></div></article></main><aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 mb-5 text-muted"><div class="access"><section id="access-lastmod"><h2 class="panel-heading">Recently Updated</h2><ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/posts/enterprise-sub-ca/">Creating an Enterprise Subordinate CA from an Offline Root CA</a><li class="text-truncate lh-lg"> <a href="/posts/ssl_certificate_management/">SSL Certificate Management</a><li class="text-truncate lh-lg"> <a href="/posts/offline-linux-ca/">Offline Root Certificate Authority - Linux</a><li class="text-truncate lh-lg"> <a href="/posts/allowing-wifi-calling/">Allowing Wifi Calling</a><li class="text-truncate lh-lg"> <a href="/posts/create-domain-join-account/">Creating a Domain Join Account in AD</a></ul></section><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/security/">security</a> <a class="post-tag btn btn-outline-primary" href="/tags/windows/">windows</a> <a class="post-tag btn btn-outline-primary" href="/tags/certificate/">certificate</a> <a class="post-tag btn btn-outline-primary" href="/tags/networking/">networking</a> <a class="post-tag btn btn-outline-primary" href="/tags/encryption/">encryption</a> <a class="post-tag btn btn-outline-primary" href="/tags/gnupg/">gnupg</a> <a class="post-tag btn btn-outline-primary" href="/tags/gpg/">gpg</a> <a class="post-tag btn btn-outline-primary" href="/tags/pgp/">pgp</a> <a class="post-tag btn btn-outline-primary" href="/tags/active-directory/">active directory</a> <a class="post-tag btn btn-outline-primary" href="/tags/ssh/">ssh</a></div></section></div><section id="toc-wrapper" class="d-none ps-0 pe-4"><h2 class="panel-heading ps-3 mb-2">Contents</h2><nav id="toc"></nav></section></aside></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4"><aside id="related-posts" aria-labelledby="related-label"><h3 class="mb-4" id="related-label">Further Reading</h3><nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><article class="col"> <a href="/posts/securing-admins-with-smart-cards-yk/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1616731200" data-df="ll" > Mar 26, 2021 </time><h4 class="pt-0 my-2">Securing Admins with Smart Cards (Yubikeys)</h4><div class="text-muted"><p>We all know that giving local admin rights to normal users is a big no-no, but what happens if an administrator’s account is compromised? What if a domain admin’s account credentials are obtained? ...</p></div></div></a></article><article class="col"> <a href="/posts/publish-rdp-certs/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1656907200" data-df="ll" > Jul 4, 2022 </time><h4 class="pt-0 my-2">Publishing Remote Desktop Certificates</h4><div class="text-muted"><p>While extremely convenient, the Remote Desktop Protocol can be extremely dangerous if not secured correctly. Typical things you should consider are ACLs, firewall rules, smart cards, RDP Gateways, ...</p></div></div></a></article><article class="col"> <a href="/posts/enterprise-sub-ca/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1656907200" data-df="ll" > Jul 4, 2022 </time><h4 class="pt-0 my-2">Creating an Enterprise Subordinate CA from an Offline Root CA</h4><div class="text-muted"><p>Every organization that has an Active Directory structure, or any other service that uses SSL/TLS services (ie. HTTPS, RDP, etc.), should have a certificate authority. This certificate authority is...</p></div></div></a></article></nav></aside><nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation"> <a href="/posts/pac-file-syntax-explained/" class="btn btn-outline-primary" aria-label="Older" ><p>PAC File Syntax Explained</p></a> <a href="/posts/securing-admins-with-smart-cards-yk/" class="btn btn-outline-primary" aria-label="Newer" ><p>Securing Admins with Smart Cards (Yubikeys)</p></a></nav><footer aria-label="Site Info" class=" d-flex flex-column justify-content-center text-muted flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3 " ><p>© <time>2024</time> <a href="https://github.com/mcnc-clovett">Chris Lovett</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >Some rights reserved.</span></p><p>Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a data-bs-toggle="tooltip" data-bs-placement="top" title="v7.1.0" href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener" >Chirpy</a> theme.</p></footer></div></div><div id="search-result-wrapper" class="d-flex justify-content-center d-none"><div class="col-11 content"><div id="search-hints"><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/security/">security</a> <a class="post-tag btn btn-outline-primary" href="/tags/windows/">windows</a> <a class="post-tag btn btn-outline-primary" href="/tags/certificate/">certificate</a> <a class="post-tag btn btn-outline-primary" href="/tags/networking/">networking</a> <a class="post-tag btn btn-outline-primary" href="/tags/encryption/">encryption</a> <a class="post-tag btn btn-outline-primary" href="/tags/gnupg/">gnupg</a> <a class="post-tag btn btn-outline-primary" href="/tags/gpg/">gpg</a> <a class="post-tag btn btn-outline-primary" href="/tags/pgp/">pgp</a> <a class="post-tag btn btn-outline-primary" href="/tags/active-directory/">active directory</a> <a class="post-tag btn btn-outline-primary" href="/tags/ssh/">ssh</a></div></section></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><aside aria-label="Scroll to Top"> <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button></aside></div><div id="mask"></div><script src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/en.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js,npm/tocbot@4.29.0/dist/tocbot.min.js"></script> <script src="/assets/js/dist/post.min.js"></script> <script>SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<article class="px-1 px-sm-2 px-lg-4 px-xl-0"><header><h2><a href="{url}">{title}</a></h2><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div></header><p>{snippet}</p></article>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
